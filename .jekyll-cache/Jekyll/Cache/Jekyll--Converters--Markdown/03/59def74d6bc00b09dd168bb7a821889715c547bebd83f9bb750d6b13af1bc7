I"›:<p>ì—¬íƒœ í† ì´ í”„ë¡œì íŠ¸ ì´ê±´, íšŒì‚¬ í”„ë¡œì íŠ¸ ì´ê±´ Rest API ë§Œ ì‚¬ìš©í–ˆì—ˆëŠ”ë°, ì§€ê¸ˆ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê³µìœ  ì˜¤í”¼ìŠ¤ì—ì„œ ì•Œê²Œ ëœ ë°±ì—”ë“œ ê°œë°œìê°€ Reactì™€ GraphQL ì‚¬ìš©ë²•ì„ ë¬¼ì–´ì™€ ê´€ë ¨ë‚´ìš©ì„ ì¢€ ì°¾ì•„ë³´ë‹ˆ ë„ˆë¬´ ì‹ ì„¸ê³„ë¼ğŸ‘€ ì´ì°¸ì— GraphQLì„ ê³µë¶€í•´ ë³´ê¸°ë¡œ í–ˆë‹¤.</p>

<p>ì‚¬ìš©í•  ê¸°ìˆ  ìŠ¤íƒì€ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<ul>
  <li>Node.js + Express.js</li>
  <li>Typescript</li>
  <li>GraphQL</li>
  <li>TypeGraphQL</li>
  <li>Apollo Server</li>
  <li>MySQL</li>
  <li>Sequelize</li>
</ul>

<p><br />
ë¨¼ì € ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ê°„ë‹¨í•œ ì„œë²„ êµ¬ì¶•ì„ í•´ë³´ë ¤ í•œë‹¤.</p>

<h1 id="í”„ë¡œì íŠ¸-ìƒì„±-ë°-íƒ€ì…ìŠ¤í¬ë¦½íŠ¸-ì„¤ì •í•˜ê¸°">í”„ë¡œì íŠ¸ ìƒì„± ë° íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì„¤ì •í•˜ê¸°</h1>

<h2 id="í”„ë¡œì íŠ¸-ìƒì„±">í”„ë¡œì íŠ¸ ìƒì„±</h2>

<p>ë¨¼ì €, ì›í•˜ëŠ” ìœ„ì¹˜ì— ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“¤ê³  ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•œë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir</span> <span class="o">[</span>í”„ë¡œì íŠ¸ ì´ë¦„]
<span class="nv">$ </span><span class="nb">cd</span> <span class="o">[</span>í”„ë¡œì íŠ¸ ì´ë¦„]
<span class="nv">$ </span>npm init <span class="nt">--yes</span>
</code></pre></div></div>

<h2 id="íƒ€ì…ìŠ¤í¬ë¦½íŠ¸-ì„¤ì •">íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì„¤ì •</h2>

<p>íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì™€ nodemon, ê·¸ë¦¬ê³  ts-nodeë¥¼ ì„¤ì¹˜í•´ ì£¼ê³ , ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— <code class="highlighter-rouge">tsconfig.json</code> íŒŒì¼ì„ ìƒì„±í•œë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm i typescript nodemon ts-node <span class="nt">--save-dev</span>
</code></pre></div></div>

<p>ìƒì„±ëœ <code class="highlighter-rouge">tsconfig.json</code> íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ ì¤€ë‹¤.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"compilerOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"es6"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"module"</span><span class="p">:</span><span class="w"> </span><span class="s2">"commonjs"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"lib"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"dom"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"es6"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"outDir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dist"</span><span class="p">,</span><span class="w">         
      </span><span class="nl">"rootDir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"src"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"moduleResolution"</span><span class="p">:</span><span class="w"> </span><span class="s2">"node"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"strict"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"esModuleInterop"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">                     
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"exclude"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"node_modules"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"include"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"./src/**/*.tsx"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"./src/**/*.ts"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h1 id="expressì—-graphql-api-ì ìš©í•˜ê¸°">Expressì— GraphQL API ì ìš©í•˜ê¸°</h1>

<p>ì´ì œ ë³¸ê²©ì ìœ¼ë¡œ ì„œë²„ë¥¼ ìƒì„±í•´ ë³¼ ì°¨ë¡€.</p>

<h2 id="ë””íœë˜ì‹œ-ì„¤ì¹˜">ë””íœë˜ì‹œ ì„¤ì¹˜</h2>

<p>í•„ìš”í•œ ë””íœë˜ì‹œì™€ ì´ì™¸ ê´€ë ¨ëœ type íŒ¨í‚¤ì§€ë“¤ë„ ì„¤ì¹˜í•´ ì¤€ë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm i apollo-server-express express graphql
<span class="nv">$ </span>npm i compression morgan dotenv
</code></pre></div></div>

<h2 id="ê¸°ë³¸-express-ì„œë²„-ìƒì„±í•˜ê¸°">ê¸°ë³¸ express ì„œë²„ ìƒì„±í•˜ê¸°</h2>

<p>ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— src í´ë”ë¥¼ ìƒì„±í•˜ê³  <code class="highlighter-rouge">server.ts</code> íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ ì¤€ë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">express</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">morgan</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">morgan</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">compression</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">compression</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">dotenv</span><span class="p">.</span><span class="nx">config</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">prod</span><span class="p">:</span> <span class="nx">boolean</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">production</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="nx">prod</span> <span class="p">?</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span> <span class="p">:</span> <span class="mi">8000</span><span class="p">;</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">morgan</span><span class="p">(</span><span class="dl">'</span><span class="s1">dev</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">compression</span><span class="p">());</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">():</span> <span class="k">void</span> <span class="o">=&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s2">`\nğŸš€      GraphQL is now running on http://localhost:</span><span class="p">${</span><span class="nx">port</span><span class="p">}</span><span class="s2">/graphql`</span><span class="p">,</span>
  <span class="p">),</span>
<span class="p">);</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">package.json</code>ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•˜ê³  <code class="highlighter-rouge">npm run dev</code>ë¥¼ ì‹¤í–‰í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ì„œë²„ê°€ êµ¬ë™ë¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">...</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodemon 'src/server.ts' --exec 'ts-node' src/server.ts -e ts"</span><span class="w">
  </span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="err">...</span><span class="w">
</span></code></pre></div></div>

<h2 id="apollo-server-ì ìš©í•˜ê¸°">Apollo Server ì ìš©í•˜ê¸°</h2>

<p><a href="https://github.com/apollographql/apollo-server#readme">apollo-server</a> ê³µì‹ë¬¸ì„œì— ë”°ë¥´ë©´ GraphQLì˜ ì¿¼ë¦¬ê°€ ê°€ëŠ¥í•œ íƒ€ì… ì •ì˜(typeDefs)ì™€ ì¿¼ë¦¬ë¥¼ ìš”ì²­í–ˆì„ ë•Œ ì„œë²„ê°€ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ë¥¼ ì •ì˜í•œ ë¦¬ì¡¸ë²„(resolvers)ë¥¼ ì •ì˜í•˜ì—¬ <code class="highlighter-rouge">ApolloServer</code> ìƒì„±ìì— ë…ê²¨ì£¼ë©´ ì•„í´ë¡œ ì„œë²„ê°€ ìƒì„±ëœë‹¤.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ApolloServer</span><span class="p">,</span> <span class="nx">gql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">apollo-server-express</span><span class="dl">'</span><span class="p">;</span>
<span class="p">...</span>

<span class="kd">const</span> <span class="nx">typeDefs</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
  type Query {
    ping: String
  }
`</span><span class="p">;</span>

<span class="c1">// Provide resolver functions for your schema fields</span>
<span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">Query</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">ping</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="dl">'</span><span class="s1">ğŸ‘‹ pong! ğŸ‘‹</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">apolloServer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloServer</span><span class="p">({</span>
  <span class="nx">typeDefs</span><span class="p">,</span>
  <span class="nx">resolvers</span><span class="p">,</span>
<span class="p">});</span>
<span class="p">...</span>
</code></pre></div></div>

<p>ì´ë ‡ê²Œ ì§„í–‰í•´ë„ ë˜ì§€ë§Œ, ì´ë ‡ê²Œë§Œ ì§„í–‰í–ˆì„ ë•Œ <code class="highlighter-rouge">TepeScript</code>ì™€ <code class="highlighter-rouge">GraphQL</code>ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìƒì‚°ì„±ì´ ë–¨ì–´ì§€ëŠ” ê²ƒ ê°™ì•˜ë‹¤. ê·¸ë˜ì„œ ë„ì…í•˜ê²Œ ëœ ê²ƒì´ <a href="https://typegraphql.com/"><code class="highlighter-rouge">TypeGraphQL</code></a>ì´ë‹¤. <code class="highlighter-rouge">TypeGraphQL</code>ì€ GraphQLì˜ Queryì™€ Mutationì„ Class í˜•íƒœë¡œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤€ë‹¤.</p>

<h3 id="typegraphql-ì ìš©í•˜ê¸°">TypeGraphQL ì ìš©í•˜ê¸°</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm i apollo-server-express express graphql
<span class="nv">$ </span>npm i compression morgan dotenv
</code></pre></div></div>

<p>ìƒì„±í•œ <code class="highlighter-rouge">ApolloServer</code> ì¸ìŠ¤í„´ìŠ¤ì— <code class="highlighter-rouge">applyMiddleware</code> ë©”ì„œë“œë¥¼ ì´ìš©í•´ ì´ì „ì— ìƒì„±í•œ express ì„œë²„ë¥¼ ë„˜ê²¨ ì¤€ë‹¤. ì´ ë•Œ cors ì„¤ì •ë„ ì¶”ê°€í•´ ì¤„ ìˆ˜ ìˆë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ApolloServer</span><span class="p">,</span> <span class="nx">gql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">apollo-server-express</span><span class="dl">'</span><span class="p">;</span>
<span class="p">...</span>

<span class="kd">const</span> <span class="nx">typeDefs</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
  type Query {
    ping: String
  }
`</span><span class="p">;</span>

<span class="c1">// Provide resolver functions for your schema fields</span>
<span class="kd">const</span> <span class="nx">resolvers</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">Query</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">ping</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="dl">'</span><span class="s1">ğŸ‘‹ pong! ğŸ‘‹</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">apolloServer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ApolloServer</span><span class="p">({</span>
  <span class="nx">typeDefs</span><span class="p">,</span>
  <span class="nx">resolvers</span><span class="p">,</span>
<span class="p">});</span>

<span class="nx">apolloServer</span><span class="p">.</span><span class="nx">applyMiddleware</span><span class="p">({</span> <span class="nx">app</span><span class="p">,</span> <span class="na">cors</span><span class="p">:</span> <span class="kc">false</span> <span class="p">});</span>
<span class="p">...</span>
</code></pre></div></div>

<h2 id="í…ŒìŠ¤íŠ¸-í•´ë³´ê¸°">í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°</h2>

<p>ì´ì œ ì œëŒ€ë¡œ êµ¬ì¶•ì´ ë˜ì—ˆëŠ”ì§€ ì¿¼ë¦¬ë¥¼ ë³´ë‚´ë³´ì. ì½˜ì†”ì— ì•„ë˜ì˜¤ ê°™ì´ curl ëª…ë ¹ì–´ë¥¼ ì „ì†¡í•˜ë©´ ì‘ë‹µì´ ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°,</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-X</span> POST <span class="s2">"http://localhost:8000/graphql"</span> <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span> <span class="nt">-d</span> <span class="s1">'{"query":"{ping}"}'</span> 

<span class="o">{</span><span class="s2">"data"</span>:<span class="o">{</span><span class="s2">"ping"</span>:<span class="s2">"ğŸ‘‹ pong! ğŸ‘‹"</span><span class="o">}}</span>
</code></pre></div></div>
<p><br /></p>

<p>ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ postmanì„ í™œìš©í•´ì„œë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
<img src="/images/express-graphql-simple-setup-test.png" alt="express-graphql-simple-setup-test" title="express-graphql-simple-setup-test" /></p>
:ET