I" A<p>ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê¸° ì „ì— ì–´ë–¤ ì´ë¯¸ì§€ë¥¼ ì„ íƒí–ˆëŠ”ì§€ ë¯¸ë¦¬ ë³´ì—¬ì£¼ê³ , ëŒ€í‘œì´ë¯¸ì§€ë¥¼ ì„¤ì •í•˜ê±°ë‚˜, í•„ìš”ì—†ëŠ” íŒŒì¼ì€ ì‚­ì œí•˜ë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤. ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ë‹¤.</p>

<p>ì´ë¯¸ì§€ ë””ìŠ¤í”Œë ˆì´ëŠ” <code class="highlighter-rouge">&lt;img&gt;</code> íƒœê·¸ë¡œ í•˜ëŠ”ë°, ì´ë¥¼ ìœ„í•´ì„œëŠ” ì´ë¯¸ì§€ì— ëŒ€í•œ íŒŒì¼ ê²½ë¡œ(url)ì´ í•„ìš”í•˜ë©°, ì´ëŠ” <code class="highlighter-rouge">FileReader</code> ê°ì²´ë¥¼ í™œìš©í•´ì„œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="íŒŒì¼ì„ íƒ-input-ë§Œë“¤ê¸°">íŒŒì¼ì„ íƒ input ë§Œë“¤ê¸°</h3>

<p><a href="/study/react/ë¦¬ì•¡íŠ¸ë¡œ-ì´ë¯¸ì§€-ì—…ë¡œë”-êµ¬í˜„í•˜ê¸°/">ë¦¬ì•¡íŠ¸ë¡œ ì´ë¯¸ì§€ ì—…ë¡œë” êµ¬í˜„í•˜ê¸°</a>ì—ì„œ ì‚¬ìš©í•œ <code class="highlighter-rouge">&lt;inupt type="file"&gt;</code>ì„ ì´ìš©í•˜ì—¬, ê¸°ë³¸ íŒŒì¼ì„ íƒ í‹€ì„ ë§Œë“ ë‹¤.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">selectedFiles</span><span class="p">:</span> <span class="kc">null</span> <span class="p">};</span>
  <span class="nx">fileChangedHandler</span> <span class="o">=</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="na">selectedFiles</span><span class="p">:</span> <span class="nx">files</span>
    <span class="p">});</span>
  <span class="p">};</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className=</span><span class="s2">"App"</span> <span class="na">style=</span><span class="si">{</span><span class="p">{</span> <span class="na">marginTop</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100px</span><span class="dl">"</span> <span class="p">}</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type=</span><span class="s2">"file"</span> <span class="nt">multiple</span> <span class="na">onChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">fileChangedHandler</span><span class="si">}</span> <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="componentdidupdateë¥¼-ì´ìš©í•˜ì—¬-renderpreview-íŠ¸ë¦¬ê±°-ë§Œë“¤ê¸°">componentDidUpdateë¥¼ ì´ìš©í•˜ì—¬ renderPreview() íŠ¸ë¦¬ê±° ë§Œë“¤ê¸°</h3>

<p>ì„ íƒëœ íŒŒì¼ì´ ë°”ë€” ë•Œ ë§ˆë‹¤(stateê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤) í”„ë¦¬ë·°ë¥¼ ë‹¤ì‹œ ê·¸ë¦´ ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´ì„œ React Life Cycleì˜ <code class="highlighter-rouge">componentDidUpdate</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">componentDidUpdate</span> <span class="o">=</span> <span class="nx">prevState</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">prevState</span><span class="p">.</span><span class="nx">selectedFiles</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedFiles</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">renderPreviews</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="renderpreview-í•¨ìˆ˜-ì‘ì„±">renderPreview() í•¨ìˆ˜ ì‘ì„±</h3>

<p>ë¨¼ì €, preview ì´ë¯¸ì§€ì˜ parent nodeë¥¼ ë§Œë“¤ì–´ ì£¼ëŠ”ë° ì—¬ê¸°ì— â€˜preview-containerâ€™ë¼ëŠ” <code class="highlighter-rouge">id</code>ë¥¼ ë¶€ì—¬í•˜ì—¬ ë”ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className=</span><span class="s2">"App"</span> <span class="na">style=</span><span class="si">{</span><span class="p">{</span> <span class="na">marginTop</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100px</span><span class="dl">"</span> <span class="p">}</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type=</span><span class="s2">"file"</span> <span class="nt">multiple</span> <span class="na">onChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">fileChangedHandler</span><span class="si">}</span> <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id=</span><span class="s2">"preview-container"</span> <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">document.createElement("img")</code>ë¡œ ì´ë¯¸ì§€ íƒœê·¸ë¥¼ ë§Œë“¤ê³ , â€œpreview-containerâ€ <code class="highlighter-rouge">div</code>ì— ìì‹ë…¸ë“œë¡œ ì¶”ê°€í•´ì¤€ë‹¤.
<code class="highlighter-rouge">img</code> íƒœê·¸ì— <code class="highlighter-rouge">src</code> ì†ì„±ì„ ì£¼ì–´ì•¼ í•˜ëŠ”ë°, ì´ëŠ” <code class="highlighter-rouge">FileReader</code>ì˜ <code class="highlighter-rouge">readAsDataURL</code> ë©”ì„œë“œë¥¼ ì´ìš©í•œë‹¤. <code class="highlighter-rouge">readAsDataURL</code> ë©”ì„œë“œì˜ ì‹¤í–‰ê²°ê³¼ëŠ” <code class="highlighter-rouge">FileReader</code>ì˜ <code class="highlighter-rouge">result</code> í”„ë¡œí¼í‹°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë°, ì´ëŠ” ë©”ì„œë“œê°€ ì™„ì „íˆ ì‹¤í–‰ë˜ê³  ë‚˜ì„œì•¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, <code class="highlighter-rouge">FileReader</code>ì— <code class="highlighter-rouge">onload</code> ì´ë²¤íŠ¸í•¸ë“¤ëŸ¬ë¥¼ ë¶€ì—¬í•˜ì—¬ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ê³  ë‚˜ë©´, <code class="highlighter-rouge">img</code> íƒœê·¸ì˜ <code class="highlighter-rouge">src</code>ì— <code class="highlighter-rouge">FileReader</code>ì˜ <code class="highlighter-rouge">result</code>ë¥¼ ë¶€ì—¬í•˜ë¼. ë¼ê³  ì •ì˜í•˜ë©´ ëœë‹¤. ì½”ë“œë¡œ ë‚˜íƒ€ë‚´ë©´,</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">renderPreviews</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">selectedFiles</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">previewContainer</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">preview-container</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">selectedFiles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">preview</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">img</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">preview</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">`preview_</span><span class="p">${</span><span class="nx">i</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
      <span class="nx">previewContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">preview</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
      <span class="nx">reader</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">preview</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">reader</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="p">};</span>
      <span class="nx">reader</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">selectedFiles</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">};</span>
</code></pre></div></div>

<p><br />
ìµœì¢… ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">selectedFiles</span><span class="p">:</span> <span class="kc">null</span> <span class="p">};</span>
  <span class="nx">componentDidUpdate</span> <span class="o">=</span> <span class="nx">prevState</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">prevState</span><span class="p">.</span><span class="nx">selectedFiles</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selectedFiles</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">renderPreviews</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">};</span>

  <span class="nx">renderPreviews</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">selectedFiles</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">previewContainer</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">preview-container</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">selectedFiles</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">preview</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">img</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">preview</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">`preview_</span><span class="p">${</span><span class="nx">i</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
      <span class="nx">previewContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">preview</span><span class="p">);</span>
      <span class="kd">const</span> <span class="nx">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
      <span class="nx">reader</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">preview</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">reader</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span>
      <span class="p">};</span>
      <span class="nx">reader</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">selectedFiles</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">};</span>
  <span class="nx">fileChangedHandler</span> <span class="o">=</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">files</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="na">selectedFiles</span><span class="p">:</span> <span class="nx">files</span>
    <span class="p">});</span>
  <span class="p">};</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className=</span><span class="s2">"App"</span> <span class="na">style=</span><span class="si">{</span><span class="p">{</span> <span class="na">marginTop</span><span class="p">:</span> <span class="dl">"</span><span class="s2">100px</span><span class="dl">"</span> <span class="p">}</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type=</span><span class="s2">"file"</span> <span class="nt">multiple</span> <span class="na">onChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">fileChangedHandler</span><span class="si">}</span> <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id=</span><span class="s2">"preview-container"</span> <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></div></div>

<hr />

<p><span class="reference">ê´€ë ¨ post</span></p>

<p><a href="/study/react/ë¦¬ì•¡íŠ¸ë¡œ-ì´ë¯¸ì§€-ì—…ë¡œë”-êµ¬í˜„í•˜ê¸°/">ë¦¬ì•¡íŠ¸ë¡œ ì´ë¯¸ì§€ ì—…ë¡œë” êµ¬í˜„í•˜ê¸°</a></p>
:ET